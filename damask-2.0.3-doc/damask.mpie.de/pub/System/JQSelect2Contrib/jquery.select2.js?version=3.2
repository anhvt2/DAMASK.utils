(function(e){if(typeof e.fn.each2=="undefined"){e.fn.extend({each2:function(t){var s=e([0]),i=-1,n=this.length;while(++i<n&&(s.context=s[0]=this[i])&&t.call(s[0],i,s)!==false);return this}})}})(jQuery);(function(e,t){"use strict";if(window.Select2!==t){return}var s,i,n,r,l,a;s={TAB:9,ENTER:13,ESC:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,SHIFT:16,CTRL:17,ALT:18,PAGE_UP:33,PAGE_DOWN:34,HOME:36,END:35,BACKSPACE:8,DELETE:46,isArrow:function(e){e=e.which?e.which:e;switch(e){case s.LEFT:case s.RIGHT:case s.UP:case s.DOWN:return true}return false},isControl:function(e){var t=e.which;switch(t){case s.SHIFT:case s.CTRL:case s.ALT:return true}if(e.metaKey)return true;return false},isFunctionKey:function(e){e=e.which?e.which:e;return e>=112&&e<=123}};l=function(){var e=1;return function(){return e++}}();function o(e,t){var s=0,i=t.length,n;if(typeof e==="undefined"){return-1}if(e.constructor===String){for(;s<i;s=s+1)if(e.localeCompare(t[s])===0)return s}else{for(;s<i;s=s+1){n=t[s];if(n.constructor===String){if(n.localeCompare(e)===0)return s}else{if(n===e)return s}}}return-1}function c(e,s){if(e===s)return true;if(e===t||s===t)return false;if(e===null||s===null)return false;if(e.constructor===String)return e.localeCompare(s)===0;if(s.constructor===String)return s.localeCompare(e)===0;return false}function h(t,s){var i,n,r;if(t===null||t.length<1)return[];i=t.split(s);for(n=0,r=i.length;n<r;n=n+1)i[n]=e.trim(i[n]);return i}function u(e){return e.outerWidth()-e.width()}function d(s){var i="keyup-change-value";s.bind("keydown",function(){if(e.data(s,i)===t){e.data(s,i,s.val())}});s.bind("keyup",function(){var n=e.data(s,i);if(n!==t&&s.val()!==n){e.removeData(s,i);s.trigger("keyup-change")}})}e(document).delegate("body","mousemove",function(t){e.data(document,"select2-lastpos",{x:t.pageX,y:t.pageY})});function f(s){s.bind("mousemove",function(s){var i=e.data(document,"select2-lastpos");if(i===t||i.x!==s.pageX||i.y!==s.pageY){e(s.target).trigger("mousemove-filtered",s)}})}function p(e,s,i){i=i||t;var n;return function(){var t=arguments;window.clearTimeout(n);n=window.setTimeout(function(){s.apply(i,t)},e)}}function m(e){var t=false,s;return function(){if(t===false){s=e();t=true}return s}}function g(e,t){var s=p(e,function(e){t.trigger("scroll-debounced",e)});t.bind("scroll",function(e){if(o(e.target,t.get())>=0)s(e)})}function v(e){e.preventDefault();e.stopPropagation()}function b(t){if(!a){var s=t[0].currentStyle||window.getComputedStyle(t[0],null);a=e("<div></div>").css({position:"absolute",left:"-10000px",top:"-10000px",display:"none",fontSize:s.fontSize,fontFamily:s.fontFamily,fontStyle:s.fontStyle,fontWeight:s.fontWeight,letterSpacing:s.letterSpacing,textTransform:s.textTransform,whiteSpace:"nowrap"});e("body").append(a)}a.text(t.val());return a.width()}function w(e,t,s){var i=e.toUpperCase().indexOf(t.toUpperCase()),n=t.length;if(i<0){s.push(e);return}s.push(e.substring(0,i));s.push("<span class='select2-match'>");s.push(e.substring(i,i+n));s.push("</span>");s.push(e.substring(i+n,e.length))}function C(t){var s,i=0,n=null,r=t.quietMillis||100;return function(l){window.clearTimeout(s);s=window.setTimeout(function(){i+=1;var s=i,r=t.data,a=t.transport||e.ajax,o=t.traditional||false,c=t.type||"GET";r=r.call(this,l.term,l.page,l.context);if(null!==n){n.abort()}n=a.call(null,{url:t.url,dataType:t.dataType,data:r,type:c,traditional:o,success:function(e){if(s<i){return}var n=t.results(e,l.page);l.callback(n)}})},r)}}function S(t){var s=t,i,n=function(e){return""+e.text};if(!e.isArray(s)){n=s.text;if(!e.isFunction(n)){i=s.text;n=function(e){return e[i]}}s=s.results}return function(t){var i=t.term,r={results:[]},l;if(i===""){t.callback({results:s});return}l=function(s,r){var a,o;s=s[0];if(s.children){a={};for(o in s){if(s.hasOwnProperty(o))a[o]=s[o]}a.children=[];e(s.children).each2(function(e,t){l(t,a.children)});if(a.children.length){r.push(a)}}else{if(t.matcher(i,n(s))){r.push(s)}}};e(s).each2(function(e,t){l(t,r.results)});t.callback(r)}}function y(s){if(e.isFunction(s)){return s}return function(i){var n=i.term,r={results:[]};e(s).each(function(){var e=this.text!==t,s=e?this.text:this;if(n===""||i.matcher(n,s)){r.results.push(e?this:{id:this,text:this})}});i.callback(r)}}function x(t,s){if(e.isFunction(t))return true;if(!t)return false;throw new Error("formatterName must be a function or a falsy value")}function E(t){return e.isFunction(t)?t():t}function T(t){var s=0;e.each(t,function(e,t){if(t.children){s+=T(t.children)}else{s++}});return s}function P(e,s,i,n){var r=e,l=false,a,o,h,u,d;if(!n.createSearchChoice||!n.tokenSeparators||n.tokenSeparators.length<1)return t;while(true){o=-1;for(h=0,u=n.tokenSeparators.length;h<u;h++){d=n.tokenSeparators[h];o=e.indexOf(d);if(o>=0)break}if(o<0)break;a=e.substring(0,o);e=e.substring(o+d.length);if(a.length>0){a=n.createSearchChoice(a,s);if(a!==t&&a!==null&&n.id(a)!==t&&n.id(a)!==null){l=false;for(h=0,u=s.length;h<u;h++){if(c(n.id(a),n.id(s[h]))){l=true;break}}if(!l)i(a)}}}if(r.localeCompare(e)!=0)return e}e(document).ready(function(){e(document).delegate("body","mousedown touchend",function(s){var i=e(s.target).closest("div.select2-container").get(0),n;if(i){e(document).find("div.select2-container-active").each(function(){if(this!==i)e(this).data("select2").blur()})}else{i=e(s.target).closest("div.select2-drop").get(0);e(document).find("div.select2-drop-active").each(function(){if(this!==i)e(this).data("select2").blur()})}i=e(s.target);n=i.attr("for");if("LABEL"===s.target.tagName&&n&&n.length>0){i=e("#"+n);i=i.data("select2");if(i!==t){i.focus();s.preventDefault()}}})});function k(t,s){var i=function(){};i.prototype=new t;i.prototype.constructor=i;i.prototype.parent=t.prototype;i.prototype=e.extend(i.prototype,s);return i}i=k(Object,{bind:function(e){var t=this;return function(){e.apply(t,arguments)}},init:function(s){var i,n,r=".select2-results";this.opts=s=this.prepareOpts(s);this.id=s.id;if(s.element.data("select2")!==t&&s.element.data("select2")!==null){this.destroy()}this.enabled=true;this.container=this.createContainer();this.containerId="s2id_"+(s.element.attr("id")||"autogen"+l());this.containerSelector="#"+this.containerId.replace(/([;&,\.\+\*\~':"\!\^#$%@\[\]\(\)=>\|])/g,"\\$1");this.container.attr("id",this.containerId);this.body=m(function(){return s.element.closest("body")});if(s.element.attr("class")!==t){this.container.addClass(s.element.attr("class").replace(/validate\[[\S ]+] ?/,""))}this.container.css(E(s.containerCss));this.container.addClass(E(s.containerCssClass));this.opts.element.data("select2",this).hide().before(this.container);this.container.data("select2",this);this.dropdown=this.container.find(".select2-drop");this.dropdown.addClass(E(s.dropdownCssClass));this.dropdown.data("select2",this);this.results=i=this.container.find(r);this.search=n=this.container.find("input.select2-input");n.attr("tabIndex",this.opts.element.attr("tabIndex"));this.resultsPage=0;this.context=null;this.initContainer();this.initContainerWidth();f(this.results);this.dropdown.delegate(r,"mousemove-filtered",this.bind(this.highlightUnderEvent));g(80,this.results);this.dropdown.delegate(r,"scroll-debounced",this.bind(this.loadMoreIfNeeded));if(e.fn.mousewheel){i.mousewheel(function(e,t,s,n){var r=i.scrollTop(),l;if(n>0&&r-n<=0){i.scrollTop(0);v(e)}else if(n<0&&i.get(0).scrollHeight-i.scrollTop()+n<=i.height()){i.scrollTop(i.get(0).scrollHeight-i.height());v(e)}})}d(n);n.bind("keyup-change",this.bind(this.updateResults));n.bind("focus",function(){n.addClass("select2-focused");if(n.val()===" ")n.val("")});n.bind("blur",function(){n.removeClass("select2-focused")});this.dropdown.delegate(r,"mouseup",this.bind(function(t){if(e(t.target).closest(".select2-result-selectable:not(.select2-disabled)").length>0){this.highlightUnderEvent(t);this.selectHighlighted(t)}else{this.focusSearch()}v(t)}));this.dropdown.bind("click mouseup mousedown",function(e){e.stopPropagation()});if(e.isFunction(this.opts.initSelection)){this.initSelection();this.monitorSource()}if(s.element.is(":disabled")||s.element.is("[readonly='readonly']"))this.disable()},destroy:function(){var e=this.opts.element.data("select2");if(e!==t){e.container.remove();e.dropdown.remove();e.opts.element.removeData("select2").unbind(".select2").show()}},prepareOpts:function(s){var i,n,r,l;i=s.element;if(i.get(0).tagName.toLowerCase()==="select"){this.select=n=s.element}if(n){e.each(["id","multiple","ajax","query","createSearchChoice","initSelection","data","tags"],function(){if(this in s){throw new Error("Option '"+this+"' is not allowed for Select2 when attached to a <select> element.")}})}s=e.extend({},{populateResults:function(i,n,r){var l,a,o,c,h=this.opts.id,u=this;l=function(i,n,a){var o,c,d,f,p,m,g,v,b;for(o=0,c=i.length;o<c;o=o+1){d=i[o];f=h(d)!==t;p=d.children&&d.children.length>0;m=e("<li></li>");m.addClass("select2-results-dept-"+a);m.addClass("select2-result");m.addClass(f?"select2-result-selectable":"select2-result-unselectable");if(p){m.addClass("select2-result-with-children")}m.addClass(u.opts.formatResultCssClass(d));g=e("<div></div>");g.addClass("select2-result-label");b=s.formatResult(d,g,r);if(b!==t){g.html(u.opts.escapeMarkup(b))}m.append(g);if(p){v=e("<ul></ul>");v.addClass("select2-result-sub");l(d.children,v,a+1);m.append(v)}m.data("select2-data",d);n.append(m)}};l(n,i,0)}},e.fn.select2.defaults,s);if(typeof s.id!=="function"){r=s.id;s.id=function(e){return e[r]}}if(n){s.query=this.bind(function(s){var n={results:[],more:false},r=s.term,l,a,o;o=function(e,t){var i;if(e.is("option")){if(s.matcher(r,e.text(),e)){t.push({id:e.attr("value"),text:e.text(),element:e.get(),css:e.attr("class")})}}else if(e.is("optgroup")){i={text:e.attr("label"),children:[],element:e.get(),css:e.attr("class")};e.children().each2(function(e,t){o(t,i.children)});if(i.children.length>0){t.push(i)}}};l=i.children();if(this.getPlaceholder()!==t&&l.length>0){a=l[0];if(e(a).text()===""){l=l.not(a)}}l.each2(function(e,t){o(t,n.results)});s.callback(n)});s.id=function(e){return e.id};s.formatResultCssClass=function(e){return e.css}}else{if(!("query"in s)){if("ajax"in s){l=s.element.data("ajax-url");if(l&&l.length>0){s.ajax.url=l}s.query=C(s.ajax)}else if("data"in s){s.query=S(s.data)}else if("tags"in s){s.query=y(s.tags);s.createSearchChoice=function(e){return{id:e,text:e}};s.initSelection=function(t,i){var n=[];e(h(t.val(),s.separator)).each(function(){var t=this,i=this,r=s.tags;if(e.isFunction(r))r=r();e(r).each(function(){if(c(this.id,t)){i=this.text;return false}});n.push({id:t,text:i})});i(n)}}}}if(typeof s.query!=="function"){throw"query function not defined for Select2 "+s.element.attr("id")}return s},monitorSource:function(){this.opts.element.bind("change.select2",this.bind(function(e){if(this.opts.element.data("select2-change-triggered")!==true){this.initSelection()}}))},triggerChange:function(t){t=t||{};t=e.extend({},t,{type:"change",val:this.val()});this.opts.element.data("select2-change-triggered",true);this.opts.element.trigger(t);this.opts.element.data("select2-change-triggered",false);this.opts.element.click();if(this.opts.blurOnChange)this.opts.element.blur()},enable:function(){if(this.enabled)return;this.enabled=true;this.container.removeClass("select2-container-disabled")},disable:function(){if(!this.enabled)return;this.close();this.enabled=false;this.container.addClass("select2-container-disabled")},opened:function(){return this.container.hasClass("select2-dropdown-open")},positionDropdown:function(){var t=this.container.offset(),s=this.container.outerHeight(),i=this.container.outerWidth(),n=this.dropdown.outerHeight(),r=e(window).scrollTop()+document.documentElement.clientHeight,l=t.top+s,a=t.left,o=l+n<=r,c=t.top-n>=this.body().scrollTop(),h=this.dropdown.hasClass("select2-drop-above"),u,d,f;if(this.body().css("position")!=="static"){u=this.body().offset();l-=u.top;a-=u.left}if(h){d=true;if(!c&&o)d=false}else{d=false;if(!o&&c)d=true}if(d){l=t.top-n;this.container.addClass("select2-drop-above");this.dropdown.addClass("select2-drop-above")}else{this.container.removeClass("select2-drop-above");this.dropdown.removeClass("select2-drop-above")}f=e.extend({top:l,left:a,width:i},E(this.opts.dropdownCss));this.dropdown.css(f)},shouldOpen:function(){var t;if(this.opened())return false;t=e.Event("open");this.opts.element.trigger(t);return!t.isDefaultPrevented()},clearDropdownAlignmentPreference:function(){this.container.removeClass("select2-drop-above");this.dropdown.removeClass("select2-drop-above")},open:function(){if(!this.shouldOpen())return false;window.setTimeout(this.bind(this.opening),1);return true},opening:function(){var t=this.containerId,s=this.containerSelector,i="scroll."+t,n="resize."+t;this.container.parents().each(function(){e(this).bind(i,function(){var t=e(s);if(t.length==0){e(this).unbind(i)}t.select2("close")})});e(window).bind(n,function(){var t=e(s);if(t.length==0){e(window).unbind(n)}t.select2("close")});this.clearDropdownAlignmentPreference();if(this.search.val()===" "){this.search.val("")}this.container.addClass("select2-dropdown-open").addClass("select2-container-active");this.updateResults(true);if(this.dropdown[0]!==this.body().children().last()[0]){this.dropdown.detach().appendTo(this.body())}this.dropdown.show();this.positionDropdown();this.dropdown.addClass("select2-drop-active");this.ensureHighlightVisible();this.focusSearch()},close:function(){if(!this.opened())return;var t=this;this.container.parents().each(function(){e(this).unbind("scroll."+t.containerId)});e(window).unbind("resize."+this.containerId);this.clearDropdownAlignmentPreference();this.dropdown.hide();this.container.removeClass("select2-dropdown-open").removeClass("select2-container-active");this.results.empty();this.clearSearch();this.opts.element.trigger(e.Event("close"))},clearSearch:function(){},ensureHighlightVisible:function(){var t=this.results,s,i,n,r,l,a,o;i=this.highlight();if(i<0)return;if(i==0){t.scrollTop(0);return}s=t.find(".select2-result-selectable");n=e(s[i]);r=n.offset().top+n.outerHeight();if(i===s.length-1){o=t.find("li.select2-more-results");if(o.length>0){r=o.offset().top+o.outerHeight()}}l=t.offset().top+t.outerHeight();if(r>l){t.scrollTop(t.scrollTop()+(r-l))}a=n.offset().top-t.offset().top;if(a<0){t.scrollTop(t.scrollTop()+a)}},moveHighlight:function(t){var s=this.results.find(".select2-result-selectable"),i=this.highlight();while(i>-1&&i<s.length){i+=t;var n=e(s[i]);if(n.hasClass("select2-result-selectable")&&!n.hasClass("select2-disabled")){this.highlight(i);break}}},highlight:function(t){var s=this.results.find(".select2-result-selectable").not(".select2-disabled");if(arguments.length===0){return o(s.filter(".select2-highlighted")[0],s.get())}if(t>=s.length)t=s.length-1;if(t<0)t=0;s.removeClass("select2-highlighted");e(s[t]).addClass("select2-highlighted");this.ensureHighlightVisible()},countSelectableResults:function(){return this.results.find(".select2-result-selectable").not(".select2-disabled").length},highlightUnderEvent:function(t){var s=e(t.target).closest(".select2-result-selectable");if(s.length>0&&!s.is(".select2-highlighted")){var i=this.results.find(".select2-result-selectable");this.highlight(i.index(s))}else if(s.length==0){this.results.find(".select2-highlighted").removeClass("select2-highlighted")}},loadMoreIfNeeded:function(){var e=this.results,t=e.find("li.select2-more-results"),s,i=-1,n=this.resultsPage+1,r=this,l=this.search.val(),a=this.context;if(t.length===0)return;s=t.offset().top-e.offset().top-e.height();if(s<=0){t.addClass("select2-active");this.opts.query({term:l,page:n,context:a,matcher:this.opts.matcher,callback:this.bind(function(s){if(!r.opened())return;r.opts.populateResults.call(this,e,s.results,{term:l,page:n,context:a});if(s.more===true){t.detach().appendTo(e).text(r.opts.formatLoadMore(n+1));window.setTimeout(function(){r.loadMoreIfNeeded()},10)}else{t.remove()}r.positionDropdown();r.resultsPage=n})})}},tokenize:function(){},updateResults:function(s){var i=this.search,n=this.results,r=this.opts,l,a=this,o;if(s!==true&&(this.showSearchInput===false||!this.opened())){return}i.addClass("select2-active");function h(){n.scrollTop(0);i.removeClass("select2-active");a.positionDropdown()}function u(e){n.html(a.opts.escapeMarkup(e));h()}if(r.maximumSelectionSize>=1){l=this.data();if(e.isArray(l)&&l.length>=r.maximumSelectionSize&&x(r.formatSelectionTooBig,"formatSelectionTooBig")){u("<li class='select2-selection-limit'>"+r.formatSelectionTooBig(r.maximumSelectionSize)+"</li>");return}}if(i.val().length<r.minimumInputLength&&x(r.formatInputTooShort,"formatInputTooShort")){u("<li class='select2-no-results'>"+r.formatInputTooShort(i.val(),r.minimumInputLength)+"</li>");return}else{u("<li class='select2-searching'>"+r.formatSearching()+"</li>")}o=this.tokenize();if(o!=t&&o!=null){i.val(o)}this.resultsPage=1;r.query({term:i.val(),page:this.resultsPage,context:null,matcher:r.matcher,callback:this.bind(function(l){var o;if(!this.opened())return;this.context=l.context===t?null:l.context;if(this.opts.createSearchChoice&&i.val()!==""){o=this.opts.createSearchChoice.call(null,i.val(),l.results);if(o!==t&&o!==null&&a.id(o)!==t&&a.id(o)!==null){if(e(l.results).filter(function(){return c(a.id(this),a.id(o))}).length===0){l.results.unshift(o)}}}if(l.results.length===0&&x(r.formatNoMatches,"formatNoMatches")){u("<li class='select2-no-results'>"+r.formatNoMatches(i.val())+"</li>");return}n.empty();a.opts.populateResults.call(this,n,l.results,{term:i.val(),page:this.resultsPage,context:null});if(l.more===true&&x(r.formatLoadMore,"formatLoadMore")){n.append("<li class='select2-more-results'>"+a.opts.escapeMarkup(r.formatLoadMore(this.resultsPage))+"</li>");window.setTimeout(function(){a.loadMoreIfNeeded()},10)}this.postprocessResults(l,s);h()})})},cancel:function(){this.close()},blur:function(){this.close();this.container.removeClass("select2-container-active");this.dropdown.removeClass("select2-drop-active");if(this.search[0]===document.activeElement){this.search.blur()}this.clearSearch();this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus")},focusSearch:function(){this.search.show();this.search.focus();window.setTimeout(this.bind(function(){this.search.show();this.search.focus();this.search.val(this.search.val())}),10)},selectHighlighted:function(){var e=this.highlight(),t=this.results.find(".select2-highlighted").not(".select2-disabled"),s=t.closest(".select2-result-selectable").data("select2-data");if(s){t.addClass("select2-disabled");this.highlight(e);this.onSelect(s)}},getPlaceholder:function(){return this.opts.element.attr("placeholder")||this.opts.element.attr("data-placeholder")||this.opts.element.data("placeholder")||this.opts.placeholder},initContainerWidth:function(){function s(){var s,i,n,r,l;if(this.opts.width==="off"){return null}else if(this.opts.width==="element"){return this.opts.element.outerWidth()===0?"auto":this.opts.element.outerWidth()+"px"}else if(this.opts.width==="copy"||this.opts.width==="resolve"){s=this.opts.element.attr("style");if(s!==t){i=s.split(";");for(r=0,l=i.length;r<l;r=r+1){n=i[r].replace(/\s/g,"").match(/width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/);if(n!==null&&n.length>=1)return n[1]}}if(this.opts.width==="resolve"){s=this.opts.element.css("width");if(s.indexOf("%")>0)return s;return this.opts.element.outerWidth()===0?"auto":this.opts.element.outerWidth()+"px"}return null}else if(e.isFunction(this.opts.width)){return this.opts.width()}else{return this.opts.width}}var i=s.call(this);if(i!==null){this.container.attr("style","width: "+i)}}});n=k(i,{createContainer:function(){var t=e("<div></div>",{"class":"select2-container"}).html(["    <a href='#' onclick='return false;' class='select2-choice'>","   <span></span><abbr class='select2-search-choice-close' style='display:none;'></abbr>","   <div><b></b></div>","</a>","    <div class='select2-drop select2-offscreen'>","   <div class='select2-search'>","       <input type='text' autocomplete='off' class='select2-input'/>","   </div>","   <ul class='select2-results'>","   </ul>","</div>"].join(""));return t},opening:function(){this.search.show();this.parent.opening.apply(this,arguments);this.dropdown.removeClass("select2-offscreen")},close:function(){if(!this.opened())return;this.parent.close.apply(this,arguments);this.dropdown.removeAttr("style").addClass("select2-offscreen").insertAfter(this.selection).show()},focus:function(){this.close();this.selection.focus()},isFocused:function(){return this.selection[0]===document.activeElement},cancel:function(){this.parent.cancel.apply(this,arguments);this.selection.focus()},initContainer:function(){var e,t=this.container,i=this.dropdown,n=false;this.selection=e=t.find(".select2-choice");this.search.bind("keydown",this.bind(function(e){if(!this.enabled)return;if(e.which===s.PAGE_UP||e.which===s.PAGE_DOWN){v(e);return}if(this.opened()){switch(e.which){case s.UP:case s.DOWN:this.moveHighlight(e.which===s.UP?-1:1);v(e);return;case s.TAB:case s.ENTER:this.selectHighlighted();v(e);return;case s.ESC:this.cancel(e);v(e);return}}else{if(e.which===s.TAB||s.isControl(e)||s.isFunctionKey(e)||e.which===s.ESC){return}if(this.opts.openOnEnter===false&&e.which===s.ENTER){return}this.open();if(e.which===s.ENTER){return}}}));this.search.bind("focus",this.bind(function(){this.selection.attr("tabIndex","-1")}));this.search.bind("blur",this.bind(function(){if(!this.opened())this.container.removeClass("select2-container-active");window.setTimeout(this.bind(function(){this.selection.attr("tabIndex",this.opts.element.attr("tabIndex"))}),10)}));e.bind("mousedown",this.bind(function(e){n=true;if(this.opened()){this.close();this.selection.focus()}else if(this.enabled){this.open()}n=false}));i.bind("mousedown",this.bind(function(){this.search.focus()}));e.bind("focus",this.bind(function(){this.container.addClass("select2-container-active");this.search.attr("tabIndex","-1")}));e.bind("blur",this.bind(function(){if(!this.opened()){this.container.removeClass("select2-container-active")}window.setTimeout(this.bind(function(){this.search.attr("tabIndex",this.opts.element.attr("tabIndex"))}),10)}));e.bind("keydown",this.bind(function(e){if(!this.enabled)return;if(e.which===s.PAGE_UP||e.which===s.PAGE_DOWN){v(e);return}if(e.which===s.TAB||s.isControl(e)||s.isFunctionKey(e)||e.which===s.ESC){return}if(this.opts.openOnEnter===false&&e.which===s.ENTER){return}if(e.which==s.DELETE){if(this.opts.allowClear){this.clear()}return}this.open();if(e.which===s.ENTER){v(e);return}if(e.which<48){v(e);return}var t=String.fromCharCode(e.which).toLowerCase();if(e.shiftKey){t=t.toUpperCase()}this.search.focus();this.search.val(t);v(e)}));e.delegate("abbr","mousedown",this.bind(function(e){if(!this.enabled)return;this.clear();v(e);this.close();this.triggerChange();this.selection.focus()}));this.setPlaceholder();this.search.bind("focus",this.bind(function(){this.container.addClass("select2-container-active")}))},clear:function(){this.opts.element.val("");this.selection.find("span").empty();this.selection.removeData("select2-data");this.setPlaceholder()},initSelection:function(){var e;if(this.opts.element.val()===""){this.close();this.setPlaceholder()}else{var s=this;this.opts.initSelection.call(null,this.opts.element,function(e){if(e!==t&&e!==null){s.updateSelection(e);s.close();s.setPlaceholder()}})}},prepareOpts:function(){var t=this.parent.prepareOpts.apply(this,arguments);if(t.element.get(0).tagName.toLowerCase()==="select"){t.initSelection=function(t,s){var i=t.find(":selected");if(e.isFunction(s))s({id:i.attr("value"),text:i.text()})}}return t},setPlaceholder:function(){var e=this.getPlaceholder();if(this.opts.element.val()===""&&e!==t){if(this.select&&this.select.find("option:first").text()!=="")return;this.selection.find("span").html(this.opts.escapeMarkup(e));this.selection.addClass("select2-default");this.selection.find("abbr").hide()}},postprocessResults:function(t,s){var i=0,n=this,r=true;this.results.find(".select2-result-selectable").each2(function(e,t){if(c(n.id(t.data("select2-data")),n.opts.element.val())){i=e;return false}});this.highlight(i);if(s===true){r=this.showSearchInput=T(t.results)>=this.opts.minimumResultsForSearch;this.dropdown.find(".select2-search")[r?"removeClass":"addClass"]("select2-search-hidden");e(this.dropdown,this.container)[r?"addClass":"removeClass"]("select2-with-searchbox")}},onSelect:function(e){var t=this.opts.element.val();this.opts.element.val(this.id(e));this.updateSelection(e);this.close();this.selection.focus();if(!c(t,this.id(e))){this.triggerChange()}},updateSelection:function(e){var s=this.selection.find("span"),i;this.selection.data("select2-data",e);s.empty();i=this.opts.formatSelection(e,s);if(i!==t){s.append(this.opts.escapeMarkup(i))}this.selection.removeClass("select2-default");if(this.opts.allowClear&&this.getPlaceholder()!==t){this.selection.find("abbr").show()}},val:function(){var e,s=null,i=this;if(arguments.length===0){return this.opts.element.val()}e=arguments[0];if(this.select){this.select.val(e).find(":selected").each2(function(e,t){s={id:t.attr("value"),text:t.text()};return false});this.updateSelection(s);this.setPlaceholder()}else{if(this.opts.initSelection===t){throw new Error("cannot call val() if initSelection() is not defined")}if(!e){this.clear();return}this.opts.element.val(e);this.opts.initSelection(this.opts.element,function(e){i.opts.element.val(!e?"":i.id(e));i.updateSelection(e);i.setPlaceholder()})}},clearSearch:function(){this.search.val("")},data:function(e){var s;if(arguments.length===0){s=this.selection.data("select2-data");if(s==t)s=null;return s}else{if(!e||e===""){this.clear()}else{this.opts.element.val(!e?"":this.id(e));this.updateSelection(e)}}}});r=k(i,{createContainer:function(){var t=e("<div></div>",{"class":"select2-container select2-container-multi"}).html(["    <ul class='select2-choices'>","  <li class='select2-search-field'>","    <input type='text' autocomplete='off' class='select2-input'>","  </li>","</ul>","<div class='select2-drop select2-drop-multi' style='display:none;'>","   <ul class='select2-results'>","   </ul>","</div>"].join(""));return t},prepareOpts:function(){var t=this.parent.prepareOpts.apply(this,arguments);if(t.element.get(0).tagName.toLowerCase()==="select"){t.initSelection=function(t,s){var i=[];t.find(":selected").each2(function(e,t){i.push({id:t.attr("value"),text:t.text()})});if(e.isFunction(s))s(i)}}return t},initContainer:function(){var t=".select2-choices",i;this.searchContainer=this.container.find(".select2-search-field");this.selection=i=this.container.find(t);this.search.bind("keydown",this.bind(function(e){if(!this.enabled)return;if(e.which===s.BACKSPACE&&this.search.val()===""){this.close();var t,n=i.find(".select2-search-choice-focus");if(n.length>0){this.unselect(n.first());this.search.width(10);v(e);return}t=i.find(".select2-search-choice");if(t.length>0){t.last().addClass("select2-search-choice-focus")}}else{i.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus")}if(this.opened()){switch(e.which){case s.UP:case s.DOWN:this.moveHighlight(e.which===s.UP?-1:1);v(e);return;case s.ENTER:case s.TAB:this.selectHighlighted();v(e);return;case s.ESC:this.cancel(e);v(e);return}}if(e.which===s.TAB||s.isControl(e)||s.isFunctionKey(e)||e.which===s.BACKSPACE||e.which===s.ESC){return}if(this.opts.openOnEnter===false&&e.which===s.ENTER){return}this.open();if(e.which===s.PAGE_UP||e.which===s.PAGE_DOWN){v(e)}}));this.search.bind("keyup",this.bind(this.resizeSearch));this.search.bind("blur",this.bind(function(e){this.container.removeClass("select2-container-active");this.search.removeClass("select2-focused");this.clearSearch();e.stopImmediatePropagation()}));this.container.delegate(t,"mousedown",this.bind(function(t){if(!this.enabled)return;if(e(t.target).closest(".select2-search-choice").length>0){return}this.clearPlaceholder();this.open();this.focusSearch();t.preventDefault()}));this.container.delegate(t,"focus",this.bind(function(){if(!this.enabled)return;this.container.addClass("select2-container-active");this.dropdown.addClass("select2-drop-active");this.clearPlaceholder()}));this.clearSearch()},enable:function(){if(this.enabled)return;this.parent.enable.apply(this,arguments);this.search.removeAttr("disabled")},disable:function(){if(!this.enabled)return;this.parent.disable.apply(this,arguments);this.search.attr("disabled",true)},initSelection:function(){var e;if(this.opts.element.val()===""){this.updateSelection([]);this.close();this.clearSearch()}if(this.select||this.opts.element.val()!==""){var s=this;this.opts.initSelection.call(null,this.opts.element,function(e){if(e!==t&&e!==null){s.updateSelection(e);s.close();s.clearSearch()}})}},clearSearch:function(){var e=this.getPlaceholder();if(e!==t&&this.getVal().length===0&&this.search.hasClass("select2-focused")===false){this.search.val(e).addClass("select2-default");this.resizeSearch()}else{this.search.val(" ").width(10)}},clearPlaceholder:function(){if(this.search.hasClass("select2-default")){this.search.val("").removeClass("select2-default")}else{if(this.search.val()===" ")this.search.val("")}},opening:function(){this.parent.opening.apply(this,arguments);this.clearPlaceholder();this.resizeSearch();this.focusSearch()},close:function(){if(!this.opened())return;this.parent.close.apply(this,arguments)},focus:function(){this.close();this.search.focus()},isFocused:function(){return this.search.hasClass("select2-focused")},updateSelection:function(t){var s=[],i=[],n=this;e(t).each(function(){if(o(n.id(this),s)<0){s.push(n.id(this));i.push(this)}});t=i;this.selection.find(".select2-search-choice").remove();e(t).each(function(){n.addSelectedChoice(this)});n.postprocessResults()},tokenize:function(){var e=this.search.val();e=this.opts.tokenizer(e,this.data(),this.bind(this.onSelect),this.opts);if(e!=null&&e!=t){this.search.val(e);if(e.length>0){this.open()}}},onSelect:function(e){this.addSelectedChoice(e);if(this.select){this.postprocessResults()}if(this.opts.closeOnSelect){this.close();this.search.width(10)}else{if(this.countSelectableResults()>0){this.search.width(10);this.resizeSearch();this.positionDropdown()}else{this.close()}}this.triggerChange({added:e});this.focusSearch()},cancel:function(){this.close();this.focusSearch()},addSelectedChoice:function(t){var s=e("<li class='select2-search-choice'>"+"    <div></div>"+"    <a href='#' onclick='return false;' class='select2-search-choice-close' tabindex='-1'></a>"+"</li>"),i=this.id(t),n=this.getVal(),r;r=this.opts.formatSelection(t,s);s.find("div").replaceWith("<div>"+this.opts.escapeMarkup(r)+"</div>");s.find(".select2-search-choice-close").bind("mousedown",v).bind("click dblclick",this.bind(function(t){if(!this.enabled)return;e(t.target).closest(".select2-search-choice").fadeOut("fast",this.bind(function(){this.unselect(e(t.target));this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus");this.close();this.focusSearch()})).dequeue();v(t)})).bind("focus",this.bind(function(){if(!this.enabled)return;this.container.addClass("select2-container-active");this.dropdown.addClass("select2-drop-active")}));s.data("select2-data",t);s.insertBefore(this.searchContainer);n.push(i);this.setVal(n)},unselect:function(e){var t=this.getVal(),s,i;e=e.closest(".select2-search-choice");if(e.length===0){throw"Invalid argument: "+e+". Must be .select2-search-choice"}s=e.data("select2-data");i=o(this.id(s),t);if(i>=0){t.splice(i,1);this.setVal(t);if(this.select)this.postprocessResults()}e.remove();this.triggerChange({removed:s})},postprocessResults:function(){var e=this.getVal(),t=this.results.find(".select2-result-selectable"),s=this.results.find(".select2-result-with-children"),i=this;t.each2(function(t,s){var n=i.id(s.data("select2-data"));if(o(n,e)>=0){s.addClass("select2-disabled").removeClass("select2-result-selectable")}else{s.removeClass("select2-disabled").addClass("select2-result-selectable");
}});s.each2(function(e,t){if(t.find(".select2-result-selectable").length==0){t.addClass("select2-disabled")}else{t.removeClass("select2-disabled")}});t.each2(function(e,t){if(!t.hasClass("select2-disabled")&&t.hasClass("select2-result-selectable")){i.highlight(0);return false}})},resizeSearch:function(){var e,t,s,i,n,r=u(this.search);e=b(this.search)+10;t=this.search.offset().left;s=this.selection.width();i=this.selection.offset().left;n=s-(t-i)-r;if(n<e){n=s-r}if(n<40){n=s-r}this.search.width(n)},getVal:function(){var e;if(this.select){e=this.select.val();return e===null?[]:e}else{e=this.opts.element.val();return h(e,this.opts.separator)}},setVal:function(t){var s;if(this.select){this.select.val(t)}else{s=[];e(t).each(function(){if(o(this,s)<0)s.push(this)});this.opts.element.val(s.length===0?"":s.join(this.opts.separator))}},val:function(){var s,i=[],n=this;if(arguments.length===0){return this.getVal()}s=arguments[0];if(!s){this.opts.element.val("");this.updateSelection([]);this.clearSearch();return}this.setVal(s);if(this.select){this.select.find(":selected").each(function(){i.push({id:e(this).attr("value"),text:e(this).text()})});this.updateSelection(i)}else{if(this.opts.initSelection===t){throw new Error("val() cannot be called if initSelection() is not defined")}this.opts.initSelection(this.opts.element,function(t){var s=e(t).map(n.id);n.setVal(s);n.updateSelection(t);n.clearSearch()})}this.clearSearch()},onSortStart:function(){if(this.select){throw new Error("Sorting of elements is not supported when attached to <select>. Attach to <input type='hidden'/> instead.")}this.search.width(0);this.searchContainer.hide()},onSortEnd:function(){var t=[],s=this;this.searchContainer.show();this.searchContainer.appendTo(this.searchContainer.parent());this.resizeSearch();this.selection.find(".select2-search-choice").each(function(){t.push(s.opts.id(e(this).data("select2-data")))});this.setVal(t);this.triggerChange()},data:function(t){var s=this,i;if(arguments.length===0){return this.selection.find(".select2-search-choice").map(function(){return e(this).data("select2-data")}).get()}else{if(!t){t=[]}i=e.map(t,function(e){return s.opts.id(e)});this.setVal(i);this.updateSelection(t);this.clearSearch()}}});e.fn.select2=function(){var s=Array.prototype.slice.call(arguments,0),i,l,a,c,h=["val","destroy","opened","open","close","focus","isFocused","container","onSortStart","onSortEnd","enable","disable","positionDropdown","data"];this.each(function(){if(s.length===0||typeof s[0]==="object"){i=s.length===0?{}:e.extend({},s[0]);i.element=e(this);if(i.element.get(0).tagName.toLowerCase()==="select"){c=i.element.attr("multiple")}else{c=i.multiple||false;if("tags"in i){i.multiple=c=true}}l=c?new r:new n;l.init(i)}else if(typeof s[0]==="string"){if(o(s[0],h)<0){throw"Unknown method: "+s[0]}a=t;l=e(this).data("select2");if(l===t)return;if(s[0]==="container"){a=l.container}else{a=l[s[0]].apply(l,s.slice(1))}if(a!==t){return false}}else{throw"Invalid arguments to select2 plugin: "+s}});return a===t?this:a};e.fn.select2.defaults={width:"copy",closeOnSelect:true,openOnEnter:true,containerCss:{},dropdownCss:{},containerCssClass:"",dropdownCssClass:"",formatResult:function(e,t,s){var i=[];w(e.text,s.term,i);return i.join("")},formatSelection:function(e,s){return e?e.text:t},formatResultCssClass:function(e){return t},formatNoMatches:function(){return"No matches found"},formatInputTooShort:function(e,t){return"Please enter "+(t-e.length)+" more characters"},formatSelectionTooBig:function(e){return"You can only select "+e+" item"+(e==1?"":"s")},formatLoadMore:function(e){return"Loading more results..."},formatSearching:function(){return"Searching..."},minimumResultsForSearch:0,minimumInputLength:0,maximumSelectionSize:0,id:function(e){return e.id},matcher:function(e,t){return t.toUpperCase().indexOf(e.toUpperCase())>=0},separator:",",tokenSeparators:[],tokenizer:P,escapeMarkup:function(e){if(e&&typeof e==="string"){return e.replace(/&/g,"&amp;")}return e},blurOnChange:false};window.Select2={query:{ajax:C,local:S,tags:y},util:{debounce:p,markMatch:w},"class":{"abstract":i,single:n,multi:r}}})(jQuery);