"use strict";!function(e){function i(i,a){var n=this;n.elem=e(i),n.opts=e.extend({},t,a,n.elem.data()),n.init()}var t={pagesize:10,width:"auto",easing:"easeOutQuart",duration:500,cycle:!0,counter:!0,widthElem:void 0};i.prototype.init=function(){var e=this;e.elem.on("refresh",function(i,t){e.undoPager(),e.opts.filter=t,e.setupPager()}),e.setupPager()},i.prototype.setupPager=function(){var i,t,a,n,r,s,l,o,d,c=this,p=c.elem.find("ul"),u=e("<ul class='foswikiHidden'></ul>");for(void 0!==c.buttons&&(c.buttons.remove(),c.buttons=void 0),c.opts.filter&&(d=new RegExp(c.opts.filter,"i"),p.children("li").each(function(){var i=e(this);d.test(i.text())||i.appendTo(u)})),u.children().length&&c.elem.append(u),i=p.children("li").length,o=e("<div class='jqSerialPagerScrollPane clearfix'></div>").appendTo(c.elem),l=Math.ceil(i/c.opts.pagesize),t=0;t<l;t++)a=e("<ul class='jqSerialPagerPage'></ul>").appendTo(o),p.find("li:lt("+c.opts.pagesize+")").appendTo(a);return p.remove(),l>1&&(c.buttons=e("<div class='jqSerialPagerButtons clearfix'></div>").width(c.opts.width).insertAfter(c.elem),n=e("<a href='#' class='jqSerialPagerPrev i18n'>prev</a>").appendTo(c.buttons),r=e("<a href='#' class='jqSerialPagerNext i18n'>next</a>").appendTo(c.buttons),c.opts.counter&&(s=e("<div class='jqSerialPagerCounter'>1/"+l+"</div>").appendTo(c.buttons)),c.opts.cycle||n.css("visibility","hidden"),c.elem.serialScroll({items:".jqSerialPagerPage",prev:n,next:r,constant:!1,duration:c.opts.duration,start:0,force:!1,cycle:c.opts.cycle,lock:!1,easing:c.opts.easing,onBefore:function(e,i,t,a,o){c.opts.counter&&s.html(o+1+"/"+l),c.opts.cycle||(0===o?n.css("visibility","hidden"):n.css("visibility","visible"),o+1===l?r.css("visibility","hidden"):r.css("visibility","visible"))}})),window.setTimeout(function(){var e=(c.opts.widthElem?c.elem.find(c.opts.widthElem).first():c.elem).width();e&&c.elem.find(".jqSerialPagerPage").css("width",e+1)},0),c.elem.width(c.opts.width),l},i.prototype.undoPager=function(){var i=this,t=e("<ul></ul>");return i.elem.find(".jqSerialPagerPage>li, .foswikiHidden>li").each(function(){t.append(this)}),i.elem.find(".jqSerialPagerScrollPane").remove(),t.children().length&&t.appendTo(i.elem),t.length},e.fn.serialPager=function(t){return this.each(function(){e.data(this,"SerialPager")||e.data(this,"SerialPager",new i(this,t))})},e(function(){e(".jqSerialPager:not(.jqInitedSerialPager)").livequery(function(){e(this).serialPager().addClass("jqInitedSerialPager")})})}(jQuery);
