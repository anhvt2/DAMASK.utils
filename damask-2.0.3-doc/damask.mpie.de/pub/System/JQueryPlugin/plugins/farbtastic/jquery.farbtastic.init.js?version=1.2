"use strict";!function(c){var t={fade:250,position:"bottom",callback:function(t){c.log("new color="+t)}};function o(t,a,n){var e,r,o,i,c,s,l,d,u,f,p,b,g=(r=/^rgb\((.*?),(.*?),(.*?)\)/,7===(e=t).length?[parseInt("0x"+e.substring(1,3))/255,parseInt("0x"+e.substring(3,5))/255,parseInt("0x"+e.substring(5,7))/255]:4===e.length?[parseInt("0x"+e.substring(1,2))/15,parseInt("0x"+e.substring(2,3))/15,parseInt("0x"+e.substring(3,4))/15]:r.test(e)?[parseFloat(e.replace(r,"$1")/255),parseFloat(e.replace(r,"$2")/255),parseFloat(e.replace(r,"$3")/255)]:e);return.5<(f=(o=g)[0],p=o[1],b=o[2],i=Math.min(f,Math.min(p,b)),s=(c=Math.max(f,Math.max(p,b)))-i,(d=0)<(u=(i+c)/2)&&u<1&&(d=s/(u<.5?2*u:2-2*u)),(l=0)<s&&(c===f&&c!==p&&(l+=(p-b)/s),c===p&&c!==b&&(l+=2+(b-f)/s),c===b&&c!==f&&(l+=4+(f-p)/s),l/=6),[l,d,u])[2]?a||"#000":n||"#FFF"}function s(t,n){var a,e=n.val();function r(t){var a=o(t);n.val(t).css({"background-color":t,color:a})}return a=c.farbtastic(t).linkTo(r),e&&(r(e),a.setColor(e)),a}c(function(){var i=c("#colorpicker");0===i.length&&(i=c('<div class="ui-component-content ui-widget-content ui-hidden ui-helper-hidden" id="colorpicker"></div>').appendTo("body")),c(".jqFarbtastic:not(.jqInitedFarbtastic)").livequery(function(){var e,r=c(this),o=c.extend({},t,r.data(),r.metadata());r.addClass("jqInitedFarbtastic"),e=s(i,r),r.click(function(){var a,n;function t(){var t;0===r.length&&n?window.clearInterval(n):(t=r.offset(),"left"===o.position&&(t.left+=r.outerWidth()),"bottom"===o.position&&(t.top+=r.outerHeight()),a&&a.top===t.top&&a.left===t.left||(a=t,i.css({top:t.top,left:t.left})))}e=s(i,r),t(),n=window.setInterval(t,500),i.farbtastic().fadeIn(o.fade)}).blur(function(){i.farbtastic().hide(),"function"==typeof o.callback&&o.callback.call(e,e.color)})})}),c(function(){var e={dark:"#000",light:"#fff"};c(".jqFarbtasticFG:not(.jqInitedFarbtasticFG)").livequery(function(){var t=c(this),a=c.extend({},e,t.metadata(),t.data()),n=o(t.css("background-color"),a.dark,a.light);t.addClass("jqInitedFarbtastic").css({color:n})})})}(jQuery);
