"use strict";!function(a){var i={mode:"manual",url:void 0,params:{},topic:void 0,section:void 0,skin:"text",select:void 0,hideEffect:"fadeOut",showEffect:"fadeIn",reloadAfter:0,delay:0,onload:function(){},finished:function(){},beforeload:function(){}};function o(e,o){var t=this;t.elem=a(e),t.container=t.elem.contents().wrapAll("<div class='jqLoaderContainer'></div>"),t.opts=a.extend({},i,o),t.init(),"auto"===t.opts.mode?t.loadAfter():t.opts.reloadAfter&&t.loadAfter(t.opts.reloadAfter)}o.prototype.init=function(){var t=this;t.elem.on("refresh.jqloader",function(e,o){a.extend(t.opts,o),t.loadAfter(0)}),"function"==typeof t.opts.onload&&t.elem.on("onload.jqloader",function(){t.opts.onload.call(t)}),"function"==typeof t.opts.beforeload&&t.elem.on("beforeload.jqloader",function(){t.opts.beforeload.call(t)}),"function"==typeof t.opts.finished&&t.elem.on("finished.jqLoader",function(){t.opts.finished.call(t)}),t.opts.reloadAfter&&t.elem.on("finished.jqLoader",function(){t.loadAfter(t.opts.reloadAfter)})},o.prototype.loadAfter=function(e){var o=this;e=e||o.opts.delay,void 0!==o.timer&&(window.clearTimeout(o.timer),o.timer=void 0),e?o.timer=window.setTimeout(function(){o.load()},e):o.load()},o.prototype.load=function(){var t=this,e=t.opts.web||foswiki.getPreference("WEB"),o=t.opts.topic||foswiki.getPreference("TOPIC"),i=a.extend({},t.opts.params),n=t.opts.url;void 0===n&&(n=foswiki.getScriptUrl("view",e,o)),void 0!==t.opts.section&&(i.section=t.opts.section),void 0!==t.opts.skin&&t.opts.skin&&(i.skin=t.opts.skin),t.opts.hideEffect&&t.container.animateCSS({effect:t.opts.hideEffect}),t.elem.trigger("beforeload.jqloader",t),a.get(n,i,function(e){void 0!==t.opts.select&&(e=a(e).find(t.opts.select)),t.elem.empty(),t.container=a("<div class='jqLoaderContainer' />").appendTo(t.elem),t.container.append(e),t.elem.trigger("onload.jqloader",t);var o=t.opts.effect||t.opts.showEffect;o?t.container.animateCSS({effect:o}).on("stop.animate",function(){t.elem.trigger("finished.jqLoader",t)}):t.elem.trigger("finished.jqLoader",t)},"html")},a.fn.jqLoader=function(e){return this.each(function(){a.data(this,"jqLoader")||a.data(this,"jqLoader",new o(this,e))})},a(".jqLoader").livequery(function(){var e=a(this),o=a.extend({},e.data(),e.metadata());e.jqLoader(o)})}(jQuery);
