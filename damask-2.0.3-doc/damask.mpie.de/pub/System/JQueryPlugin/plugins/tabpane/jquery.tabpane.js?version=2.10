"use strict";var bottomBarHeight=-1;!function(l){var i={select:1,animate:!1,autoMaxExpand:!1,remember:!1,minHeight:0};function e(t,e){var a=this;a.elem=l(t),a.opts=l.extend({},i,a.elem.data(),e),a.init()}e.prototype.init=function(){var a,i,n=this;n.id=n.getId(),n.elem.prepend('<span class="foswikiClear"></span>'),a=l('<ul class="jqTabGroup clearfix"></ul>').prependTo(n.elem),i=1,n.elem.find("> .jqTab").each(function(){var t=l(this),e=t.find(".jqTabLabel:first").remove().html();a.append('<li><a href="#" data-index="'+i+'">'+e+"</a></li>"),t.data("index",i),i++}),void 0===n.currentIndex&&n.switchTab(1),n.opts.autoMaxExpand&&n.autoMaxExpand(),n.elem.find(".jqTabGroup > li > a").on("click",function(){var t=l(this),e=t.data("index");return t.blur(),e!==n.currentIndex&&(n.switchTab(e),n.opts.remember&&n.setHash(e)),!1}),n.opts.remember?(l(window).bind("hashchange",function(){n.switchTab(n.getHash()||n.opts.select||1)}),n.switchTab(n.getHash()||n.opts.select||1)):n.switchTab(n.opts.select||1)},e.prototype.parseHash=function(){var t,e,a=window.location.hash.replace(/^.*#!/,"").split(";"),i={},n=a.length;for(e=0;e<n;e++)2==(t=a[e].split("=")).length&&(i[t[0]]=parseInt(t[1],10));return i},e.prototype.getId=function(){var t=this,e=t.elem.attr("id");return 1<l("#"+e+".jqTabPane").length?(e=parseInt(e.replace(/^tabpane/,""),10),t.elem.prop("id","tabpane"+(e+1)),t.getId()):e},e.prototype.getHash=function(){return this.parseHash()[this.id]},e.prototype.setHash=function(t){var e=this,a=e.parseHash(),i=[];t!==a[e.id]&&(void 0!==t?a[e.id]=t:delete a[e.id],l.each(a,function(t,e){l.isArray(e)&&(e=join("|",e)),i.push(t+="="+e)}),i="!"+i.join(";"),window.location.hash=i)},e.prototype.getTab=function(t){var e,a=this;return void 0!==(e="object"==typeof(t=t||a.currentIndex||a.opts.select)?t:"number"==typeof t?a.elem.find("> .jqTab").eq(t-1):a.elem.find(t))&&0==e.length&&(e=void 0),e},e.prototype.getNextTab=function(t){var e=this.getTab(t);if(e)return this.getTab(e.data("index")+1)},e.prototype.hideTab=function(t){var e,a=this,i=a.getTab(t);i&&(e=i.data("index"),i.hide(),a.getNaviOfTab(e).hide(),a.switchTab(e+1))},e.prototype.showTab=function(t){var e,a=this.getTab(e);a&&(e=a.data("index"),this.getNaviOfTab(e).show(),a.show())},e.prototype.getNaviOfTab=function(t){var e,a=this.getTab(t);return a?(e=a.data("index"),this.elem.find("> .jqTabGroup li a").eq(e-1)):l()},e.prototype.switchTab=function(t){var e,a,i,n,o,r,s,d,h=this,p=h.currentIndex,c=h.getTab(t);function u(){var t,e="none";0<i&&(e="easeInOutQuad"),h.opts.autoMaxExpand?h.opts.animate&&"none"!==e&&s.css({opacity:0}).animate({opacity:1},300):h.opts.animate&&"none"!==e&&(o.height("auto"),t=o.height(),d?(o.height(i).animate({height:t},300,e,function(){o.height("auto")}),s.css({opacity:0}).animate({opacity:1},300,e)):o.height(i).css({opacity:0}).animate({opacity:1,height:t},300,e,function(){o.height("auto")})),l(window).trigger("resize"),void 0!==r.afterHandler&&window[r.afterHandler].call(h,p,n),h.currentIndex=n}c&&(void 0!==p&&(a=(e=h.getTab(p)).find(".jqTabContents:first"),p=e.data("index"),i=a.height()),n=c.data("index"),p!==n&&(e&&(e.removeClass("current").hide(),h.getNaviOfTab(p).parent().removeClass("current")),c.addClass("current").show(),h.getNaviOfTab(n).parent().addClass("current"),void 0!==(r=c.data()).beforeHandler&&window[r.beforeHandler].call(h,p,n),o=c.find(".jqTabContents:first"),(h.opts.animate||h.opts.autoMaxExpand)&&0<i&&!o.is(".jqTabDisableMaxExpand")&&o.height(i),s=o,d=!1,void 0!==r.container&&((s=o.find(r.container)).length?d=!0:s=o),void 0!==r.url?(s.load(r.url,void 0,function(){void 0!==r.afterLoadHandler&&window[r.afterLoadHandler].call(h,p,n),u()}),c.removeData("url")):u()))},e.prototype.autoMaxExpand=function(){var t=this;window.setTimeout(function(){t.fixHeight(),l(window).one("resize.tabpane",function(){t.autoMaxExpand()})},100)},e.prototype.fixHeight=function(){var t,e=this,a=e.elem.find("> .jqTab.current .jqTabContents:first"),i=l(window).height()||window.innerHeight;a.length&&!a.is(".jqTabDisableMaxExpand")&&(bottomBarHeight<=0&&(bottomBarHeight=l(".natEditBottomBar").outerHeight(!0)+a.outerHeight(!0)-a.height()),t=i-a.offset().top-bottomBarHeight-2,e.opts&&e.opts.minHeight&&t<e.opts.minHeight&&(t=e.opts.minHeight),t<0||a.height(t))},l.fn.tabpane=function(t){return this.each(function(){l.data(this,"tabPane")||l.data(this,"tabPane",new e(this,t))})},l(function(){l(".jqTabPane:not(.jqInitedTabpane)").livequery(function(){l(this).tabpane().addClass("jqInitedTabpane")})})}(jQuery);
