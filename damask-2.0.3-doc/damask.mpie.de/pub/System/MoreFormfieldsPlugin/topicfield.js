"use strict";jQuery(function(u){var t={minimumInputLength:0,placeholder:"None",url:null,width:"element",multiple:!1,quietMillis:500};function l(e){return e.thumbnail?"<div class='image-item' style='background-image:url(\""+e.thumbnail+"\")'>"+e.text+"</div>":e.text}u(".foswikiTopicField:not(.foswikiTopicFieldInited)").livequery(function(){var e=u(this),n=u.extend({},t,e.data()),i=u.extend({},n),o=e.val();delete i.minimumInputLength,delete i.url,delete i.width,delete i.quietMillis,delete i.valueText,e.addClass("foswikiTopicFieldInited"),e.select2({allowClear:!0,dropdownCssClass:"ui-dialog",placeholder:n.placeholder,minimumInputLength:n.minimumInputLength,width:n.width,multiple:n.multiple,ajax:{url:n.url,dataType:"json",data:function(e,t){return u.extend({},{q:e,limit:10,page:t},i)},results:function(e,t){return e.more=10*t<e.total,e}},initSelection:function(e,t){var i,l;if(n.multiple)i=[],u(o.split(/\s*,\s*/)).each(function(e){l=n.valueText[this]||this;try{l=decodeURIComponent(l),i.push({id:this,text:l,thumbnail:n.thumbnail[this]})}catch(e){console&&console.error("Error: illegal value in topicfield:",l)}});else{l=n.valueText;try{l=decodeURIComponent(l),i={id:o,text:l,thumbnail:n.thumbnail}}catch(e){console&&console.error("Error: illegal value in topicfield:",l)}}t(i)},formatResult:l,formatSelection:l})})});
